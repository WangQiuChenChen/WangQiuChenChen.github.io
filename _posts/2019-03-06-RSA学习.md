---
title: "RSA学习"
categories:
  - Thinking
tags:
  - 学习
last_modified_at: 2019-02-23
toc: true
toc_label: "文章提纲"
---

##  RSA算法简介

 选择两个大素数p和q，计算出模数N = p * q

 计算φ = (p−1) * (q−1) 即N的欧拉函数，然后选择一个e (1<e<φ)，且e和φ互质

 取e的模反数为d，计算方法: e * d ≡ 1 (mod φ)

 对明文m进行加密：c = pow(m, e, N)，得到的c即为密文

 对密文c进行解密，m = pow(c, d, N)，得到的m即为明文
        
        
 各种参数：

 p 和 q ：大整数N的两个因子（factor）

 N：大整数N，我们称之为模数（modulus

 e 和 d：互为模反数的两个指数（exponent）

 c 和 m：分别是密文和明文，这里一般指的是一个十进制的

（N，e）：公钥

（N，d）：私钥
        
##  CTF中的RSA题型


1.公钥加密文

最常见最基础的题型，出题人会给你一个公钥文件（通常是以.pem或.pub结尾的文件）和密文（通常叫做flag.enc之类的），你需要分析公钥，提取出（N，e），通过各种攻击手段恢复私钥，然后去解密密文得到flag。

2.文本文档

对于第一种题型，可以直接给你一个txt文本文档，里面直接写出了（N，e，c）所对应的十进制数值，然后你直接拿去用就行了。当然也不都是给出（N，e，c）的值，有时还会给出其他一些参数，这时就需要思考，这题具体考察的什么攻击方法

3.pcap文件

有时出题人会给你一个流量包，需要用wireshark等工具分析，然后根据流量包的通信信息，分析题目考察的攻击方法，你可以提取出所有解题需要用到的参数，然后进行解密

4.本地脚本分析

题目会给一个脚本和一段密文，一般为python编写，你需要逆向文件流程，分析脚本的加密过程，写出对应的解密脚本进行解密

5.远程脚本利用

这种题型一般难度较大。题目会给一个运行在远程服务器上的python脚本和服务器地址，你需要分析脚本存在的漏洞，确定攻击算法，然后编写脚本与服务器交互，得到flag


## 尝试解最基础RSA

1.一开始尝试使用openssl，但配置难度较大，失败。

2.开始尝试找别的小工具，我尝试的是一个自动化的工具，来帮助我们尝试可能的算法，并恢复出私钥或者解密密文。

3.①安装libnum

  git clone https://github.com/hellman/libnum.git

  cd libnum

  python setup.py install

  ②安装gmpy2

  参考原文：https://www.cnblogs.com/pcat/p/5746821.html

  原文里面有的版本过老，会安装失败，可以参考的安装过程：https://d001um3.github.io/2018/01/24/CTF-RSA-tool-install/

  ③克隆仓库，安装依赖

  git clone https://github.com/D001UM3/CTF-RSA-tool.git

  cd CTF-RSA-tool

  pip install -r "requirements.txt"
  
4.只需要把题目给的信息输入给脚本，脚本就会自动完成剩下的工作如：

  题目给了一个公钥文件和密文，直接用 --key 或 -k 指定公钥，用 –decrypt 指定密文文件就行了
  
## 今日学习总结

1.尝试openssl时间过长，总是没有一个完整的教程可以指导安装，如果以后有机会安装并配置成功，应该写一个小白教程。

2.发现小工具并简单学习后发现大神很多，都是自己设计的具有各自功能的，但是今天还没有安装好。

3.明天应该争取安装成功，尝试一下。




